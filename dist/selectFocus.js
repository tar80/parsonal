var e,t,r,n;Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var r;if(null==this)throw new TypeError('Array.indexOf: "this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return-1;var c=null!=t?t:0;if(Math.abs(c)===Infinity&&(c=0),c>=i)return-1;for(r=Math.max(c>=0?c:i-Math.abs(c),0);r<i;){if(r in n&&n[r]===e)return r;r++}return-1}),Object.keys||(Object.keys=(e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(i){if("function"!=typeof i&&("object"!=typeof i||null==i))throw new TypeError("Object.keys: called on non-object");var c,p,o=[];for(c in i)e.call(i,c)&&o.push(c);if(t)for(p=0;p<n;p++)e.call(i,r[p])&&o.push(r[p]);return o})),Object.isEmpty||(Object.isEmpty=function(e){if("function"!=typeof e&&("object"!=typeof e||null==e))throw new TypeError("Object.isEmpty: called on non-object");for(var t in e)return!1;return!0});var i=PPx.CreateObject("Scripting.FileSystemObject"),c="\r\n",p={TypeToCode:{crlf:"\r\n",cr:"\r",lf:"\n"},CodeToType:{"\r\n":"crlf","\r":"cr","\n":"lf"},Ppx:{lf:"%%bl",cr:"%%br",crlf:"%%bn",unix:"%%bl",mac:"%%br",dos:"%%bn","\n":"%%bl","\r":"%%br","\r\n":"%%bn"},Ascii:{lf:"10",cr:"13",crlf:"-1",unix:"10",mac:"13",dos:"-1","\n":"10","\r":"13","\r\n":"-1"}},o=function(e,t){try{var r;return[!1,null!=(r=t())?r:""]}catch(n){return[!0,""]}finally{e.Close()}},a=function(e){var t=e.path,r=e.data,n=e.enc,a=void 0===n?"utf8":n,l=e.append,s=void 0!==l&&l,u=e.overwrite,P=void 0!==u&&u,f=e.linefeed,x=void 0===f?c:f;if(!P&&!s&&i.FileExists(t))return[!0,t+" already exists"];var d,v=i.GetParentFolderName(t);if(i.FolderExists(v)||PPx.Execute("*makedir "+v),"utf8"===a){if("ClearScriptV8"===PPx.ScriptEngineName){var m=r.join(x),b=s?"AppendAllText":"WriteAllText";return[!1,NETAPI.System.IO.File[b](t,m)]}var y=P||s?2:1,E=PPx.CreateObject("ADODB.Stream");d=o(E,(function(){E.Open(),E.Charset="UTF-8",E.LineSeparator=Number(p.Ascii[x]),s?(E.LoadFromFile(t),E.Position=E.Size,E.SetEOS):E.Position=0,E.WriteText(r.join(x),1),E.SaveToFile(t,y)}))[0]}else{var h=s?8:P?2:1;i.FileExists(t)||PPx.Execute("%Osq *makefile "+t);var O="utf16le"===a?-1:0,w=i.GetFile(t).OpenAsTextStream(h,O);d=o(w,(function(){w.Write(r.join(x)+x)}))[0]}return d?[!0,"Could not write to "+t]:[!1,""]};"1"===PPx.getValue("selectfocus")&&PPx.Quit(1);var l="M_temp",s="PPe",u="PPeditW",P="-- =",f=PPx.windowIDName,x=function(e){var t=PPx.Arguments.length>0?PPx.Arguments.Item(0):"";if(""===t||/^[BCV#]#?$/.test(t)){var r=PPx.Extract("%*ppxlist(-"+t+")").slice(0,-1).split(",");return r.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1})),"0"!==e&&r.push(s),r}},d=function(e,t){return PPx.Extract("%*extract("+e+',"'+t+'")').slice(-30).replace(/\\t/g,"\\\\t")},v=function(e,t){var r=e.length;return t&&r>0&&e.splice(0,0,P),t||r>0},m=function(e,t,r){for(var n={ppc:[],ppv:[],ppb:[],ppcust:[],ppe:[]},i=[],c=i[0],p=i[1],o=i[2],a=0;a<e;a++)if(o=(c=t[a]).substring(0,2),p=c.slice(-1),"C_"===o)n.ppc.push("PPc:&"+p+" "+d(c,"%%FD")+" = "+c);else if("V_"===o)n.ppv.push("PPv:&"+p+" "+d(c,"%%FC")+" = "+c);else if("B_"===o)n.ppb.push("PPb:&"+p+" "+d(c,"%%FD")+" = "+c);else if("cs"===o){var s=PPx.Extract('%*findwindowtitle("PPx Customizer")');n.ppcust.push("PPcust:&"+p+" = #"+s)}else"PP"===o&&n.ppe.push("PPe:&@ = #"+r);var u=v(n.ppv,0!==n.ppc.length);return u=v(n.ppb,u),u=v(n.ppcust,u),u=v(n.ppe,u),[l+"\t= {"].concat(n.ppc,n.ppv,n.ppb,n.ppcust,n.ppe,["}"])};!function(){var e=PPx.Extract("%*findwindowclass("+u+")"),t=x(e),r=function(){var e,t,r=PPx.ScriptName;return~r.indexOf("\\")?(e=r.replace(/^.*\\/,""),t=PPx.Extract("%*name(DKN,"+r+")")):(e=r,t=PPx.Extract("%FDN")),{scriptName:e,parentDir:t.replace(/\\$/,"")}}(),n=r.scriptName;t||(PPx.Echo(n+": 引数が不正"),PPx.Quit(-1)),~t.indexOf(f)&&t.splice(t.indexOf(f),1);var i,c=t.length;if(1===c)PPx.Execute("*selectppx "+t[0]);else if(c>1){var p=(i=PPx.Extract('%*extract(C,"%%*temp()")'),{dir:i,file:i+"_ppmtemp",lf:i+"_temp.xlf",stdout:i+"_stdout",stderr:i+"_stderr",ppmDir:function(){var e=PPx.Extract("%'temp'%\\ppm");return PPx.Execute("*makedir "+e),e}}).file,o=a({path:p,data:m(c,t,e),enc:"utf16le",linefeed:"\r\n",overwrite:!0}),s=o[0],P=o[1];s&&(PPx.Echo(n+": "+P),PPx.Quit(-1)),PPx.setValue("selectfocus",1),PPx.Execute("*setcust @"+p),PPx.Execute('%k"@down"%:*focus %'+l),PPx.Execute('*deletecust "'+l+'"'),PPx.Execute("*wait 1000,2"),PPx.setValue("selectfocus","")}}();
