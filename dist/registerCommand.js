var r,validArgs=function(){for(var r=[],t=PPx.Arguments;!t.atEnd();t.moveNext())r.push(t.value);return r},t=PPx.CreateObject("Scripting.FileSystemObject"),isEmptyStr=function(r){return""===r},isEmptyObj=function(r){if(r===undefined)return!1;if(null===r)return!0;for(var t in r)return!1;return!0};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/,"")}),Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var r=[],t=0,e=this.length;t<e;t++){var n=this[t];null==n||""===n||n instanceof Array&&0===n.length||n instanceof Object&&isEmptyObj(n)||r.push(n)}return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(r,t){var e;if(null==this)throw new Error('Array.indexOf: "this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return-1;var u=null!=t?t:0;if(Math.abs(u)===Infinity&&(u=0),u>=i)return-1;for(e=Math.max(u>=0?u:i-Math.abs(u),0);e<i;){if(e in n&&n[e]===r)return e;e++}return-1}),r=PPx.Extract("%*getcust(S_ppm#global:git)"),isEmptyStr(r);var _setStdin=function(r,t){return r?'-io:string,"'+r+'"':t?'-io:send,"'+t.join("%bl")+'"':""},runStdout=function(r){var t=r.cmdline,e=r.wd,n=r.extract,i=void 0!==n&&n,u=r.startmsg,a=void 0!==u&&u,o=r.hide,s=void 0!==o&&o,f=r.utf8,c=void 0!==f&&f,l=r.trim,p=void 0!==l&&l,x=r.single,m=r.multi,v=[s?"-noppb -hide":"-min",a?"":"-nostartmsg",e?"-d:"+e:"",c?"-io:utf8":"",_setStdin(x,m)].join(" ");i||(t="%("+t+"%)");var d=PPx.Extract("%OC %*run("+v+" "+t+")"),h=Number(PPx.Extract());return p&&!isEmptyStr(d)&&(d=d.trim()),[h,d]},e=/^(.+)\..+$/,n=/^path\s=\s"?([^"]+)"?$/,shimToPath=function(r){var i=runStdout({cmdline:"where.exe "+r+" 2>nul",startmsg:!1,hide:!0,trim:!0,utf8:!1}),u=i[0],a=i[1];if(0===u&&!isEmptyStr(a)){if(a.indexOf("\\shims\\")){var o=a.replace(e,"$1.shim");if(t.FileExists(o)){var s=PPx.Extract("%*insertValue("+o+")");isEmptyStr(s)||(a=s.replace(n,"$1"))}}return[0,a]}return[-1,r]},registPath=function(r,t){var e=PPx.Extract("%g'"+t+"'");if(!isEmptyStr(e))return[-1,e];var n=shimToPath(t),i=n[0],u=n[1];return PPx.Execute("*set "+t.toUpperCase()+"="+u),[i,u]},main=function(){var r=validArgs()[0];return r||(PPx.report("[shellcmdRegister] warn: argument is not specified"),PPx.Quit(-1)),registPath(!1,r)[1]};PPx.result=main();
