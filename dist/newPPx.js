var t,validArgs=function(){for(var t=[],r=PPx.Arguments;!r.atEnd();r.moveNext())t.push(r.value);return t},safeArgs=function(){for(var t=[],r=validArgs(),n=0,e=arguments.length;n<e;n++)t.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],r[n]));return t},_valueConverter=function(t,r){if(null==r||""===r)return null!=t?t:undefined;switch(typeof t){case"number":var n=Number(r);return isNaN(n)?t:n;case"boolean":return null!=r&&"false"!==r&&"0"!==r;default:return r}},isEmptyStr=function(t){return""===t},isEmptyObj=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var r in t)return!1;return!0},r=PPx.CreateObject("Scripting.FileSystemObject");String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/,"")}),Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var t=[],r=0,n=this.length;r<n;r++){var e=this[r];null==e||""===e||e instanceof Array&&0===e.length||e instanceof Object&&isEmptyObj(e)||t.push(e)}return t}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,r){var n;if(null==this)throw new Error('Array.indexOf: "this" is null or not defined');var e=Object(this),i=e.length>>>0;if(0===i)return-1;var u=null!=r?r:0;if(Math.abs(u)===Infinity&&(u=0),u>=i)return-1;for(n=Math.max(u>=0?u:i-Math.abs(u),0);n<i;){if(n in e&&e[n]===t)return n;n++}return-1}),t=PPx.Extract("%*getcust(S_ppm#global:git)"),isEmptyStr(t);var _setStdin=function(t,r){return t?'-io:string,"'+t+'"':r?'-io:send,"'+r.join("%bl")+'"':""},runStdout=function(t){var r=t.cmdline,n=t.wd,e=t.extract,i=void 0!==e&&e,u=t.startmsg,a=void 0!==u&&u,o=t.hide,f=void 0!==o&&o,s=t.utf8,c=void 0!==s&&s,l=t.trim,x=void 0!==l&&l,p=t.single,v=t.multi,d=[f?"-noppb -hide":"-min",a?"":"-nostartmsg",n?"-d:"+n:"",c?"-io:utf8":"",_setStdin(p,v)].join(" ");i||(r="%("+r+"%)");var m=PPx.Extract("%OC %*run("+d+" "+r+")"),h=Number(PPx.Extract());return x&&!isEmptyStr(m)&&(m=m.trim()),[h,m]},n=/^(.+)\..+$/,e=/^path\s=\s"?([^"]+)"?$/,shimToPath=function(t){var i=runStdout({cmdline:"where.exe "+t+" 2>nul",startmsg:!1,hide:!0,trim:!0,utf8:!1}),u=i[0],a=i[1];if(0===u&&!isEmptyStr(a)){if(a.indexOf("\\shims\\")){var o=a.replace(n,"$1.shim");if(r.FileExists(o)){var f=PPx.Extract("%*insertValue("+o+")");isEmptyStr(f)||(a=f.replace(e,"$1"))}}return[0,a]}return[-1,t]},registPath=function(t,r){var n=PPx.Extract("%g'"+r+"'");if(!isEmptyStr(n))return[-1,n];var e=shimToPath(r),i=e[0],u=e[1];return PPx.Execute("*set "+r.toUpperCase()+"="+u),[i,u]},ppvCmdline=function(t){if(/^.+\.txt$/.test(t)){var r=runStdout({cmdline:'"'+registPath(!1,"nkf")+'" -g "'+t+'"',hide:!0,trim:!0,utf8:!1}),n=r[0],e=r[1];if(0===n)switch(e){case"UTF-8":return'-utf8 "'+t+'"';case"UTF-16":return'-utf16 "'+t+'"'}}return'"'+t+'"'},main=function(){var t=safeArgs(PPx.WindowIDName.substring(0,1))[0];i[t]()},i={C:function(){var t=nextId("C","ABCDEFGHIJKLMNOPQRSTUVWYZ");return PPx.Execute("*ppc -single -mps -bootid:"+t+' %FD -k %%J"%R"')},V:function(){var t=nextId("V","DEFGHIJKLMNOPQRSTUVW"),r=PPx.Extract("%FDCN");return PPx.Execute("*ppv -bootid:"+t+" "+ppvCmdline(r))}},nextId=function(t,r){for(var n=0,e=r.length;n<e;n++)if(isEmptyStr(PPx.Extract("%N"+t+r[n])))return r[n];return"Z"};main();
