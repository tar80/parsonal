var r,validArgs=function(){for(var r=[],t=PPx.Arguments;!t.atEnd();t.moveNext())r.push(t.value);return r},t=PPx.CreateObject("Scripting.FileSystemObject"),isEmptyStr=function(r){return""===r},isEmptyObj=function(r){if(r===undefined)return!1;if(null===r)return!0;for(var t in r)return!1;return!0};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/,"")}),Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var r=[],t=0,n=this.length;t<n;t++){var e=this[t];null==e||""===e||e instanceof Array&&0===e.length||e instanceof Object&&isEmptyObj(e)||r.push(e)}return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(r,t){var n;if(null==this)throw new Error('Array.indexOf: "this" is null or not defined');var e=Object(this),i=e.length>>>0;if(0===i)return-1;var u=null!=t?t:0;if(Math.abs(u)===Infinity&&(u=0),u>=i)return-1;for(n=Math.max(u>=0?u:i-Math.abs(u),0);n<i;){if(n in e&&e[n]===r)return n;n++}return-1}),r=PPx.Extract("%*getcust(S_ppm#global:git)"),isEmptyStr(r);var _setStdin=function(r,t){return r?'-io:string,"'+r+'"':t?'-io:send,"'+t.join("%bl")+'"':""},runStdout=function(r){var t=r.cmdline,n=r.wd,e=r.extract,i=void 0!==e&&e,u=r.startmsg,a=void 0!==u&&u,o=r.hide,f=void 0!==o&&o,s=r.utf8,c=void 0!==s&&s,l=r.trim,v=void 0!==l&&l,p=r.single,x=r.multi,h=[f?"-noppb -hide":"-min",a?"":"-nostartmsg",n?"-d:"+n:"",c?"-io:utf8":"",_setStdin(p,x)].join(" ");i||(t="%("+t+"%)");var m=PPx.Extract("%OC %*run("+h+" "+t+")"),d=Number(PPx.Extract());return v&&!isEmptyStr(m)&&(m=m.trim()),[d,m]},n=/^(.+)\..+$/,e=/^path\s=\s"?([^"]+)"?$/,shimToPath=function(r){var i=runStdout({cmdline:"where.exe "+r+" 2>nul",startmsg:!1,hide:!0,trim:!0,utf8:!1}),u=i[0],a=i[1];if(0===u&&!isEmptyStr(a)){if(a.indexOf("\\shims\\")){var o=a.replace(n,"$1.shim");if(t.FileExists(o)){var f=PPx.Extract("%*insertValue("+o+")");isEmptyStr(f)||(a=f.replace(e,"$1"))}}return[0,a]}return[-1,r]},registPath=function(r,t){var n=PPx.Extract("%g'"+t+"'");if(!isEmptyStr(n))return[-1,n];var e=shimToPath(t),i=e[0],u=e[1];return 0===i&&PPx.Execute("*alias "+t+"="+u),[i,u]},main=function(){for(var r=validArgs(),t=[],n=0,e=r.length;n<e;n++){var i=registPath(!0,r[n]),u=i[0],a=i[1];0===u&&t.push(r[n]+"="+a)}return t.join(",")};PPx.result=main();
