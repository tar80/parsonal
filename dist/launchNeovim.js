var t=PPx.CreateObject("Scripting.FileSystemObject"),e=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["0","100","edit",undefined],r=0,n=t.length;r<n;r++)e[r]=t.Item(r);if(i=e[0],/0|-1/.test(i)){var i;if(function(t){return/^(edit|args|diff|command)$/.test(t)}(e[2]))return{process:e[0],port:e[1],order:e[2],option:e[3]};""!==e[2]&&PPx.Echo("Wrong value passed. arg2:"+e[2])}else PPx.Echo("Wrong value passed. arg0:"+e[0])},r=function(e){return(e=1024&t.GetFile(e).Attributes?PPx.Extract("%*linkedpath("+e+")"):e).replace(/([^\\])\s/g,"$1\\ ")},n=function(e){for(var n,i=e?e.replace(/\\\s/g," "):PPx.Extract("%#;FDCN"),o=e?2:PPx.EntryMarkCount,a=~i.indexOf(";")?";":" ",u=o<2?[i]:i.split(a),s=u.length,c=[],P=0;P<s;P++)if(n=u[P].replace(/"/g,""),t.FileExists(n))c.push(r(n));else{var f=!1;for(P++;P<s;P++)if(n=n+" "+u[P].replace(/"/g,""),t.FileExists(n)){c.push(r(n)),f=!0;break}if(!f)return[!1,"Failed to extract path"]}return[!0,c]},i=function(t,e){return!t},o={edit:function(t){var e=t.option,r=n(e),o=r[0],a=r[1];return i(o)?[!1,a]:[!0,"edit "+a[0]]},args:function(t){var e=t.option,r=n(e),o=r[0],a=r[1];return i(o)?[!1,a]:[!0,PPx.EntryMarkCount>1?"args! "+a.join(" "):"edit "+a[0]]},diff:function(t){var e=t.option,r=null!=e?e:2===PPx.EntryMarkCount?PPx.Extract("%#;FDCN"):PPx.Extract("%FDCN")+";"+PPx.Extract("%~FDCN"),o=n(r),a=o[0],u=o[1];return i(a)?[!1,u]:[!0,"silent! edit "+u[1]+"|silent! vertical diffsplit "+u[0]]},command:function(t){var e=t.option;return null==e?[!1,"Empty command line"]:[!0,e]}},a=function(t,e){return{0:'--remote-send "<Cmd>'+e+'<CR>"',"-1":'--remote-send "<Cmd>stopinsert|tabnew|'+e+'<CR>"'}[t]};PPx.result=function(){var t=e();if(!t)return"-1";var r=o[t.order](t),n=r[0],i=r[1];if(!n)return PPx.linemessage('!"'+i),"-1";var u=a(t.process,i);return PPx.Execute('*launch -noppb -hide nvim --server "\\\\.\\pipe\\nvim.'+t.port+'.0" '+u),"0"}();
