var t=function(t){void 0===t&&(t=PPx.Arguments);for(var r,n=["0","100","edit",undefined],e=0,i=t.length;e<i;e++)n[e]=t.Item(e);if(r=n[0],!/0|-1/.test(r))throw new Error("Wrong value passed. arg0:"+n[0]);if(!function(t){return/^(edit|args|diff|command)$/.test(t)}(n[2]))throw new Error("Wrong value passed. arg2:"+n[2]);return{process:n[0],port:n[1],order:n[2],option:n[3]}},r=function(t){for(var r,n=t||PPx.Extract("%#;FDCN"),e=t?2:PPx.EntryMarkCount,i=~n.indexOf(";")?";":" ",o=e<2?[n]:n.split(i),a=o.length,u=[],s=PPx.CreateObject("Scripting.FileSystemObject"),c=0;c<a;c++){if(r=PPx.Extract("%*linkedpath("+o[c]+")")||o[c].replace(/"/g,""),!s.FileExists(r)){for(c++;c<a&&(r=PPx.Extract("%*linkedpath("+r+" "+o[c]+")")||r+" "+o[c],!s.FileExists(r));c++);return[!1,"Failed to extract path"]}u.push(r)}return[!0,u]},n=function(t,r){return!t},e={edit:function(t){var e=t.option,i=r(e),o=i[0],a=i[1];return n(o)?[!1,a]:[!0,"edit "+a[0]]},args:function(t){var e=t.option,i=r(e),o=i[0],a=i[1];return n(o)?[!1,a]:[!0,PPx.EntryMarkCount>1?"args! "+a.join(" "):"edit "+a[0]]},diff:function(t){var e=t.option,i=null!=e?e:2===PPx.EntryMarkCount?PPx.Extract("%#;FDCN"):PPx.Extract("%FDCN")+";"+PPx.Extract("%~FDCN"),o=r(i),a=o[0],u=o[1];return n(a)?[!1,u]:[!0,"silent! edit "+u[1]+"|silent! vertical diffsplit "+u[0]]},command:function(t){var r=t.option;return null==r?[!1,"Empty command line"]:[!0,r]}},i=function(t,r){return{0:'--remote-send "<Cmd>'+r+'<CR>"',"-1":'--remote-send "<Cmd>stopinsert|tabnew|'+r+'<CR>"'}[t]};!function(){var r=t(),n=e[r.order](r),o=n[0],a=n[1];if(!o)return PPx.linemessage('!"'+a);var u=i(r.process,a);PPx.Execute('%Obd nvim --server "\\\\.\\pipe\\nvim.'+r.port+'.0" '+u)}();
