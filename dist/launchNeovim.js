var isBottom=function(e){return null==e},validArgs=function(){for(var e=[],t=PPx.Arguments;!t.atEnd();t.moveNext())e.push(t.value);return e},safeArgs=function(){for(var e=[],t=validArgs(),n=0,r=arguments.length;n<r;n++)e.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],t[n]));return e},_valueConverter=function(e,t){if(null==t||""===t)return null!=e?e:undefined;switch(typeof e){case"number":var n=Number(t);return isNaN(n)?e:n;case"boolean":return"false"!==t&&"0"!==t&&null!=t;default:return t}},e=1024,t=PPx.CreateObject("Scripting.FileSystemObject"),main=function(){var e=safeArgs(!1,"100","edit",undefined),t=e[0],r=e[1],i=e[2],u=e[3];if(!function(e){return/^(edit|args|diff|command)$/.test(e)}(i))return PPx.Echo("Wrong value passed. arg2:"+i),"-1";var a=n[i](u),l=a[0],f=a[1];if(!l)return PPx.linemessage('!"'+f),"-1";var s=t.toString(),c=exCmd(s,f);return PPx.Execute('*launch -noppb -hide nvim --server "\\\\.\\pipe\\nvim.'+r+'.0" '+c),"0"},getActualPath=function(n){return(n=t.GetFile(n).Attributes&e?PPx.Extract("%*linkedpath("+n+")"):n).replace(/([^\\])\s/g,"$1\\ ")},extractPath=function(e){for(var n,r=e?e.replace(/\\\s/g," "):PPx.Extract("%#;FDCN"),i=e?2:PPx.EntryMarkCount,u=~r.indexOf(";")?";":" ",a=i<2?[r]:r.split(u),l=a.length,f=[],s=0;s<l;s++)if(n=a[s].replace(/"/g,""),t.FileExists(n))f.push(getActualPath(n));else{var c=!1;for(s++;s<l;s++)if(n=n+" "+a[s].replace(/"/g,""),t.FileExists(n)){f.push(getActualPath(n)),c=!0;break}if(!c)return[!1,"Failed to extract path"]}return[!0,f]},isError=function(e,t){return!e},n={edit:function(e){var t=extractPath(e),n=t[0],r=t[1];return isError(n)?[!1,r]:[!0,"edit "+r[0]]},args:function(e){var t=extractPath(e),n=t[0],r=t[1];return isError(n)?[!1,r]:[!0,PPx.EntryMarkCount>1?"args! "+r.join(" "):"edit "+r[0]]},diff:function(e){var t=null!=e?e:2===PPx.EntryMarkCount?PPx.Extract("%#;FDCN"):PPx.Extract("%FDCN")+";"+PPx.Extract("%~FDCN"),n=extractPath(t),r=n[0],i=n[1];return isError(r)?[!1,i]:[!0,"silent! edit "+i[1]+"|silent! vertical diffsplit "+i[0]]},command:function(e){return isBottom(e)?[!1,"Empty command line"]:[!0,e]}},exCmd=function(e,t){return{"false":'--remote-send "<Cmd>'+t+'<CR>"',"true":'--remote-send "<Cmd>stopinsert|tabnew|'+t+'<CR>"'}[e]};PPx.result=main();
