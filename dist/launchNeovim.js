var t=PPx.CreateObject("Scripting.FileSystemObject"),r=function(t){void 0===t&&(t=PPx.Arguments);for(var r=["0","100","edit",undefined],e=0,n=t.length;e<n;e++)r[e]=t.Item(e);if(i=r[0],/0|-1/.test(i)){var i;if(function(t){return/^(edit|args|diff|command)$/.test(t)}(r[2]))return{process:r[0],port:r[1],order:r[2],option:r[3]};PPx.Echo("Wrong value passed. arg2:"+r[2])}else PPx.Echo("Wrong value passed. arg0:"+r[0])},e=function(r){return(r=1024&t.GetFile(r).Attributes?PPx.Extract("%*linkedpath("+r+")"):r).replace(/([^\\])\s/g,"$1\\ ")},n=function(r){for(var n,i=r?r.replace(/\\\s/g," "):PPx.Extract("%#;FDCN"),o=r?2:PPx.EntryMarkCount,a=~i.indexOf(";")?";":" ",u=o<2?[i]:i.split(a),s=u.length,c=[],P=0;P<s;P++)if(n=u[P].replace(/"/g,""),t.FileExists(n))c.push(e(n));else{var f=!1;for(P++;P<s;P++)if(n=n+" "+u[P].replace(/"/g,""),t.FileExists(n)){c.push(e(n)),f=!0;break}if(!f)return[!1,"Failed to extract path"]}return[!0,c]},i=function(t,r){return!t},o={edit:function(t){var r=t.option,e=n(r),o=e[0],a=e[1];return i(o)?[!1,a]:[!0,"edit "+a[0]]},args:function(t){var r=t.option,e=n(r),o=e[0],a=e[1];return i(o)?[!1,a]:[!0,PPx.EntryMarkCount>1?"args! "+a.join(" "):"edit "+a[0]]},diff:function(t){var r=t.option,e=null!=r?r:2===PPx.EntryMarkCount?PPx.Extract("%#;FDCN"):PPx.Extract("%FDCN")+";"+PPx.Extract("%~FDCN"),o=n(e),a=o[0],u=o[1];return i(a)?[!1,u]:[!0,"silent! edit "+u[1]+"|silent! vertical diffsplit "+u[0]]},command:function(t){var r=t.option;return null==r?[!1,"Empty command line"]:[!0,r]}},a=function(t,r){return{0:'--remote-send "<Cmd>'+r+'<CR>"',"-1":'--remote-send "<Cmd>stopinsert|tabnew|'+r+'<CR>"'}[t]};PPx.result=function(){var t=r();if(!t)return"-1";var e=o[t.order](t),n=e[0],i=e[1];if(!n)return PPx.linemessage('!"'+i),"-1";var u=a(t.process,i);return PPx.Execute('%Obd nvim --server "\\\\.\\pipe\\nvim.'+t.port+'.0" '+u),"0"}();
