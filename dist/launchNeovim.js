var e=function(){for(var e=[],r=function(){var e,t=[];e=PPx.Arguments.length;for(var r=0;r<e;r++)t.push(PPx.Argument(r));return t}(),n=0,i=arguments.length;n<i;n++)e.push(t(n<0||arguments.length<=n?undefined:arguments[n],r[n]));return e},t=function(e,t){if(null==t||""===t)return null!=e?e:undefined;switch(typeof e){case"number":var r=Number(t);return isNaN(r)?e:r;case"boolean":return"false"!==t&&"0"!==t&&null!=t;default:return t}},r=PPx.CreateObject("Scripting.FileSystemObject"),n=function(e){return(e=1024&r.GetFile(e).Attributes?PPx.Extract("%*linkedpath("+e+")"):e).replace(/([^\\])\s/g,"$1\\ ")},i=function(e){for(var t,i=e?e.replace(/\\\s/g," "):PPx.Extract("%#;FDCN"),u=e?2:PPx.EntryMarkCount,a=~i.indexOf(";")?";":" ",l=u<2?[i]:i.split(a),s=l.length,f=[],c=0;c<s;c++)if(t=l[c].replace(/"/g,""),r.FileExists(t))f.push(n(t));else{var o=!1;for(c++;c<s;c++)if(t=t+" "+l[c].replace(/"/g,""),r.FileExists(t)){f.push(n(t)),o=!0;break}if(!o)return[!1,"Failed to extract path"]}return[!0,f]},u=function(e,t){return!e},a={edit:function(e){var t=i(e),r=t[0],n=t[1];return u(r)?[!1,n]:[!0,"edit "+n[0]]},args:function(e){var t=i(e),r=t[0],n=t[1];return u(r)?[!1,n]:[!0,PPx.EntryMarkCount>1?"args! "+n.join(" "):"edit "+n[0]]},diff:function(e){var t=null!=e?e:2===PPx.EntryMarkCount?PPx.Extract("%#;FDCN"):PPx.Extract("%FDCN")+";"+PPx.Extract("%~FDCN"),r=i(t),n=r[0],a=r[1];return u(n)?[!1,a]:[!0,"silent! edit "+a[1]+"|silent! vertical diffsplit "+a[0]]},command:function(e){return null==e?[!1,"Empty command line"]:[!0,e]}},l=function(e,t){return{"false":'--remote-send "<Cmd>'+t+'<CR>"',"true":'--remote-send "<Cmd>stopinsert|tabnew|'+t+'<CR>"'}[e]};PPx.result=function(){var t=e(!1,"100","edit",undefined),r=t[0],n=t[1],i=t[2],u=t[3];if(!/^(edit|args|diff|command)$/.test(i))return PPx.Echo("Wrong value passed. arg2:"+i),"-1";var s=a[i](u),f=s[0],c=s[1];if(!f)return PPx.linemessage('!"'+c),"-1";var o=r.toString(),P=l(o,c);return PPx.Execute('*launch -noppb -hide nvim --server "\\\\.\\pipe\\nvim.'+n+'.0" '+P),"0"}();
