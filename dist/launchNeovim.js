var t=PPx.CreateObject("Scripting.FileSystemObject"),e=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["0","100","edit",undefined],r=0,n=t.length;r<n;r++)e[r]=t.Item(r);if(i=e[0],/0|-1/.test(i)){var i;if(function(t){return/^(edit|args|diff|command)$/.test(t)}(e[2]))return{process:e[0],port:e[1],order:e[2],option:e[3]};""!==e[2]&&PPx.linemessage("Wrong value passed. arg2:"+e[2])}else PPx.Echo("Wrong value passed. arg0:"+e[0])},r=function(e){return(e=1024&t.GetFile(e).Attributes?PPx.Extract("%*linkedpath("+e+")"):e).replace(/([^\\])\s/g,"$1\\ ")},n=function(e){for(var n,i=e?e.replace(/\\\s/g," "):PPx.Extract("%#;FDCN"),a=e?2:PPx.EntryMarkCount,o=~i.indexOf(";")?";":" ",s=a<2?[i]:i.split(o),u=s.length,c=[],P=0;P<u;P++)if(n=s[P].replace(/"/g,""),t.FileExists(n))c.push(r(n));else{var f=!1;for(P++;P<u;P++)if(n=n+" "+s[P].replace(/"/g,""),t.FileExists(n)){c.push(r(n)),f=!0;break}if(!f)return[!1,"Failed to extract path"]}return[!0,c]},i=function(t,e){return!t},a={edit:function(t){var e=t.option,r=n(e),a=r[0],o=r[1];return i(a)?[!1,o]:[!0,"edit "+o[0]]},args:function(t){var e=t.option,r=n(e),a=r[0],o=r[1];return i(a)?[!1,o]:[!0,PPx.EntryMarkCount>1?"args! "+o.join(" "):"edit "+o[0]]},diff:function(t){var e=t.option,r=null!=e?e:2===PPx.EntryMarkCount?PPx.Extract("%#;FDCN"):PPx.Extract("%FDCN")+";"+PPx.Extract("%~FDCN"),a=n(r),o=a[0],s=a[1];return i(o)?[!1,s]:[!0,"silent! edit "+s[1]+"|silent! vertical diffsplit "+s[0]]},command:function(t){var e=t.option;return null==e?[!1,"Empty command line"]:[!0,e]}},o=function(t,e){return{0:'--remote-send "<Cmd>'+e+'<CR>"',"-1":'--remote-send "<Cmd>stopinsert|tabnew|'+e+'<CR>"'}[t]};PPx.result=function(){var t=e();if(!t)return"-1";var r=a[t.order](t),n=r[0],i=r[1];if(!n)return PPx.linemessage('!"'+i),"-1";var s=o(t.process,i);return PPx.Execute('%Obd nvim --server "\\\\.\\pipe\\nvim.'+t.port+'.0" '+s),"0"}();
