var e=PPx.CreateObject("Scripting.FileSystemObject"),t="\r\n",r={TypeToCode:{crlf:"\r\n",cr:"\r",lf:"\n"},CodeToType:{"\r\n":"crlf","\r":"cr","\n":"lf"},Ppx:{lf:"%%bl",cr:"%%br",crlf:"%%bn",unix:"%%bl",mac:"%%br",dos:"%%bn","\n":"%%bl","\r":"%%br","\r\n":"%%bn"},Ascii:{lf:"10",cr:"13",crlf:"-1",unix:"10",mac:"13",dos:"-1","\n":"10","\r":"13","\r\n":"-1"}},n=function(e,t){try{var r;return[!1,null!=(r=t())?r:""]}catch(n){return[!0,""]}finally{e.Close()}},i=function(i){var a=i.path,l=i.data,u=i.enc,o=void 0===u?"utf8":u,s=i.append,c=void 0!==s&&s,f=i.overwrite,P=void 0!==f&&f,d=i.linefeed,x=void 0===d?t:d;if(!P&&!c&&e.FileExists(a))return[!0,a+" already exists"];var p,v=e.GetParentFolderName(a);if(e.FolderExists(v)||PPx.Execute("*makedir "+v),"utf8"===o){if("ClearScriptV8"===PPx.ScriptEngineName){var m=l.join(x),F=c?"AppendAllText":"WriteAllText";return[!1,NETAPI.System.IO.File[F](a,m)]}var g=P||c?2:1,h=PPx.CreateObject("ADODB.Stream");p=n(h,(function(){h.Open(),h.Charset="UTF-8",h.LineSeparator=Number(r.Ascii[x]),c?(h.LoadFromFile(a),h.Position=h.Size,h.SetEOS):h.Position=0,h.WriteText(l.join(x),1),h.SaveToFile(a,g)}))[0]}else{var b=c?8:P?2:1;e.FileExists(a)||PPx.Execute("%Osq *makefile "+a);var E="utf16le"===o?-1:0,S=e.GetFile(a).OpenAsTextStream(b,E);p=n(S,(function(){S.Write(l.join(x)+x)}))[0]}return p?[!0,"Could not write to "+a]:[!1,""]},a=function(){for(var e=[],t=function(){var e,t=[];e=PPx.Arguments.length;for(var r=0;r<e;r++)t.push(PPx.Argument(r));return t}(),r=0,n=arguments.length;r<n;r++)e.push(l(r<0||arguments.length<=r?undefined:arguments[r],t[r]));return e},l=function(e,t){if(null==t||""===t)return null!=e?e:undefined;switch(typeof e){case"number":return Number(t)||e;case"boolean":return"false"!==t&&"0"!==t&&null!=t;default:return t}},u=function(e){return""+PPx.Extract("%*temp()")+PPx.Extract('%*name(X,"'+e+'")')},o=function(e,t){var r=e.match(/Type\s*\/Page[^s]/g);if(!r)return 0;var n=r.length;return t?Math.min(t,n):n},s=function(e){for(var t=[],r=0;r<e;r++)t.push(("00"+(r+1)).slice(-3));return t};!function(){var t=a(PPx.Extract("%FDC"),99),r=t[0],l=t[1],c=PPx.Extract("%FD"),f=u(r);if(":PDF"===PPx.GetFileInformation(r)){var P=function(t){var r=t.path,i=t.enc,a=void 0===i?"utf8":i;if(!e.FileExists(r))return[!0,r+" not found"];var l=e.GetFile(r);if(0===l.Size)return[!0,r+" has no data"];var u=!1,o="";if("utf8"===a){var s=PPx.CreateObject("ADODB.Stream"),c=n(s,(function(){return s.Open(),s.Charset="UTF-8",s.LoadFromFile(r),s.ReadText(-1)}));u=c[0],o=c[1]}else{var f="utf16le"===a?-1:0,P=l.OpenAsTextStream(1,f),d=n(P,(function(){return P.ReadAll()}));u=d[0],o=d[1]}return u?[!0,"Unable to read "+r]:[!1,o]}({path:r}),d=P[0],x=P[1];if(d)PPx.linemessage("Could not read file");else{var p=o(x,l);if(0!==p){var v=s(p),m=[";ListFile",";Base="+f,c].concat(v),F=f+"\\page";if(!e.FileExists(F)){var g=i({path:F,data:m});if(d=g[0],x=g[1],d)return void PPx.linemessage("Failed to write ListFile");PPx.Execute("%On *cd "+f+"%:*ppb -c %(%'scoop'\\ghostscript\\current\\gswin64c.exe -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r400 -dTextAlphaBits=4 -dDownScaleFactor=2 -dFirstPage=1 -dLastPage="+p+' -sOutputFile="%%03d" "'+r+'"%)')}PPx.Execute("*jumppath "+F)}else PPx.linemessage("Could not get page number")}}else PPx.linemessage("Not a PDF file")}();
